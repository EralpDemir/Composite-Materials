function [K,F] = FEM_assemble(iele,nnpe,conn, ke,fe,K,F,dof)% assembles elemental force and stiffness matrices into global counterpartsfor  i = 1:1:nnpe    i_glonod_f = dof*conn(iele,i);    i_glonod_s = dof*conn(iele,i)-dof+1;    i_locnod_f = dof*i;    i_locnod_s = dof*i-dof+1;    F(i_glonod_s:1:i_glonod_f) = F(i_glonod_s:1:i_glonod_f) + fe(i_locnod_s:1:i_locnod_f);    for j = 1:1:nnpe        j_glonod_f = dof*conn(iele,j);        j_glonod_s = dof*conn(iele,j)-dof+1;        j_locnod_f = dof*j;        j_locnod_s = dof*j-dof+1;        K(i_glonod_s:1:i_glonod_f , j_glonod_s:1:j_glonod_f) = ...            K(i_glonod_s:1:i_glonod_f , j_glonod_s:1:j_glonod_f) + ...            ke(i_locnod_s:1:i_locnod_f , j_locnod_s:1:j_locnod_f);    endend    end